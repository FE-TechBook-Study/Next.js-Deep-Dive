Next.js는 애플리케이션의 속도와 Core Web Vitals를 개선하기 위해 다양한 내장 최적화를 제공한다.

이 가이드에서는 사용자 경험을 향상시키는 최적화 기능을 다룬다.

## 내장 컴포넌트

- Images (`next/image` )
  - 기본 HTML `<img>` 요소를 기반으로 하여, 이미지의 성능을 최적화한다.
  - lazy loading 및 기기별 자동 크기 조정(responsive sizing) 기능을 지원한다.
- Link (`next/link` )
  - 기본 HTML `<a>` 태그를 기반으로 동작한다.
  - 백그라운드에서 페이지를 prefetch(사전 로드)하여 더 빠르고 부드러운 페이지 전환을 제공한다.
- Script(`next/script` )
  - 기본 HTML `<script>` 태그를 기반으로 동작하여, 서드파티 스크립트의 로딩 및 실행을 제어할 수 있다.

## Metadata

메타데이터는 검색 엔진이 콘텐츠를 더 잘 이해하도록 도와 SEO(검색 엔진 최적화)에 기여하며, 소셜 미디어에서 콘텐츠를 더 효과적으로 표시할 수 있도록 한다.

Next.js에서는 `Metadata API` 를 사용하여 `<head>` 요소를 수정할 수 있으며, 이를 설정하는 방법은 두 가지 가 있다.

1. 설정 기반 메타데이터 (Config-based Metadata)
   - `layout.js` 또는 `page.js` 파일에서 정적인 `metadata` 객체 또는 동적인 `generateMetadata` 함수를 내보낼 수 있다.
2. 파일 기반 메타데이터 (File-based Metadata)
   - 특정 파일을 라우트 세그먼트에 추가하여 정적 또는 동적으로 메타데이터를 설정할 수 있다.

추가적으로 JSX와 CSS를 사용하여 동적 Open Graph 이미지를 생성할 수도 있다. (`imageResponse` 생성자를 사용)

## Static Assets

Next.js 는 public 폴더를 사용하여 정적 자산(이미지, 폰트, 기타 파일)을 제공할 수 있다.

- public 폴더의 파일은 CDN(콘텐츠 전송 네트워크)에 의해 캐싱될 수 있어 더 효율적으로 제공된다.

## 분석 및 모니터링

Next.js는 대규모 애플리케이션을 위한 분석 및 모니터링 도구와 통합할 수 있다.

## 최적화 기능 정리

- **이미지 최적화** → `next/image` 컴포넌트 사용
- **비디오 최적화** → Next.js 애플리케이션에서 비디오를 최적화하는 권장사항
- **폰트 최적화** → `next/font` 로더를 사용하여 웹 폰트를 최적화
- **메타데이터 최적화** → `Metadata API` 활용
- **스크립트 최적화** → `next/script`을 사용해 서드파티 스크립트 최적화
- **번들 분석** → `@next/bundle-analyzer` 플러그인으로 JavaScript 번들 크기 분석
- **지연 로딩 (Lazy Loading)** → 라이브러리 및 React 컴포넌트의 지연 로딩으로 초기 로딩 성능 향상
- **페이지 분석 (Analytics)** → Next.js Speed Insights를 사용해 페이지 성능 측정 및 추적
- **계측 (Instrumentation)** → 서버 시작 시 실행되는 코드를 설정하는 방법
- **OpenTelemetry** → OpenTelemetry를 활용한 Next.js 애플리케이션 계측
- **정적 자산 (Static Assets)** → `/public` 디렉토리에서 정적 파일 제공
- **서드파티 라이브러리 최적화** → `@next/third-parties` 패키지를 사용해 서드파티 라이브러리 성능 개선
- **메모리 사용 최적화** → 개발 및 프로덕션 환경에서 애플리케이션의 메모리 사용을 최적화
