# Routing

- Tree: 계층적 구조를 시각화하기 위한 관례. 예를 들어, 부모와 자식 컴포넌트로 구성된 컴포넌트 트리나 폴더 구조 등이 있음.
- Subtree: 트리의 일부로, 새로운 루트(시작점)에서 시작하여 끝 노드(리프)까지 이어지는 구조.
- Root: 트리나 서브트리에서 첫 번째 노드로, 예를 들어 루트 레이아웃이 여기에 해당.
- Leaf: 자식 노드가 없는 트리 또는 서브트리의 노드를 말하며, 예를 들어 URL 경로의 마지막 세그먼트 등이 이에 해당.
- URL Segment: 슬래시(`/`)로 구분된 URL 경로의 일부.
- URL Path: 도메인 뒤에 오는 URL의 일부로, 여러 세그먼트로 구성.

## App Router

버전 13부터 Next.js는 App Router를 도입하였다.

App Router는 React Server Components 를 기반으로 만들어졌으며, shared layout, nested routing, loading state, error handling 등을 지원한다.

`app` 디렉토리에서 동작하는데, 이는 `pages` 디렉토리와 함께 사용 가능하며, 점진적으로 새로운 기능을 적용할 수 있다.

App Router는 Pages Router보다 우선순위를 가진다. 두 디렉토리가 동일한 URL 경로로 라우트를 설정할 경우, 충돌을 방지하기 위해 빌드 시 오류가 발생한다.

## Roles of Folders and Files

Next.js는 파일 시스템 기반 라우터를 사용하며, 다음과 같이 동작하낟.

- 폴더는 라우트를 정의하는 데 사용된다. 라우트는 루트 폴더에서 시작해 `page.js` 파일이 포함된 최종 리프 폴더까지 파일 시스템 계층을 따라가는 단일 경로이다.
- 파일은 특정 라우트 세그먼트에 대해 표시되는 UI를 생성하는데 사용된다.

## Route Segments

라우트의 각 폴더는 하나의 라우트 세그먼트를 나타낸다. 각 라우트 세그먼트는 URL 경로의 해당 세그먼트에 매핑된다.

## Component Hierarchy

특별한 파일로 정의된 React 컴포넌트는 특정 계층 구조로 렌더링된다.

1. layout
2. template
3. error
4. loading
5. not-found
6. page 또는 중첩된 layout

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/a43c8b7f-e77d-47de-a59c-f74de1fb0eee/53d079c9-18de-432b-9b86-7622d82eb136/image.png)

## Colocation

특별 파일 외에도, `app` 디렉토리 내 폴더에 사용자 정의 파일 (컴포넌트, 스타일, 테스트 등)을 함께 배치할 수 있다.

이는 폴더가 라우트를 정의하지만, `page.js` 혹은 `route.js` 가 반환하는 내용만 공개적으로 접근 가능하기 때문이다.
